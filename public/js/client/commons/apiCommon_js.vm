/*
 * Created on $today.date ( Time $today.time )
 * Generated by $generator.name ( version $generator.version )
 * Client common api functions
 */

/**
 * Check if the client can connect to the server application
 * @param callback
 */
function pingServer(callback) {
    var status;
    ${DOLLAR}.ajax({
        url: '/ping',
        type: 'GET',
        async: true,
        success: function (data) {
            // Ready for SQLite insertion.
            status = 0;
            callback(status, data.url);
        },
        error: function () {
            status = 1;
            callback(status);
        }
    });
}

/**
 * Uses pingServer function to display server connection status
 * @param app
 */
function connectionStatus(app) {
    pingServer(function (status, url) {
        if (status === 0) {
            let message = 'Server connection successful';
            displayHome(app, message, url);
        } else {
            let message = 'Server connection lost. Synchronizing...';
            displayHome(app, message, url);
        }
    })
}

/**
 * Display connection status, server url & port to the client
 * @params app, url, message
 */
function displayHome(app, url, message) {
    app.message = message;
    app.url = url;
}